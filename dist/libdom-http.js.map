{"version":3,"file":"libdom-http.js","sources":["../src/lib/chain.js","../node_modules/rollup-plugin-node-globals/src/global.js","../src/lib/detect.js","../src/lib/driver.js","../src/lib/type.js","../src/lib/transform/helper.js","../src/lib/transform/request-json.js","../src/lib/transform/response-json.js","../src/lib/transform/request-form-urlencoded.js","../src/lib/transform/request-form-multipart.js","../src/lib/transform.js","../src/lib/driver/base.js","../src/lib/driver/xhr.js","../src/lib/driver/xhr2.js","../src/lib/driver/form-upload.js","../src/lib/transform/response-text-plain.js","../src/lib/transform/request-html5-form-data.js","../src/lib/header.js","../src/lib/operation.js","../src/lib/request.js","../src/all.js","../src/index.js"],"sourcesContent":["'use strict';\n\nvar MAIN_MODULE;\n\nexport\n    function use(mainModule) {\n        MAIN_MODULE = mainModule;\n    }\n    \nexport\n    function get() {\n        return MAIN_MODULE;\n    }","export default typeof global !== \"undefined\" ? global :\n            typeof self !== \"undefined\" ? self :\n            typeof window !== \"undefined\" ? window : {}\n","'use strict';\n\nimport DOM from \"libdom\";\n\n\nvar ENV = DOM.env,\n    G = global,\n    XHR = G.XMLHttpRequest,\n    support_xhr = !!XHR,\n    support_xhrx = false,\n    support_xhrmime = false,\n    support_xhrtime = false,\n    support_xhrbin = false,\n    support_xhrprogress = false,\n    support_xdr = !!G.XDomainRequest;\n\nif (ENV) {\n    if (ENV.browser) {\n        if (XHR) {\n            XHR = XHR.prototype;\n            support_xhrx = 'withCredentials' in XHR;\n            support_xhrmime = 'overrideMimeType' in XHR;\n            support_xhrtime = 'timeout' in XHR;\n            support_xhrbin = 'sendAsBinary' in XHR;\n            support_xhrprogress = 'onprogress' in XHR;\n        }\n        \n    }\n    else if (ENV.node) {\n        \n    }\n}\n\nexport default {\n        xhr: support_xhr,\n        xhrx: support_xhrx,\n        xhrmime: support_xhrmime,\n        xhrtime: support_xhrtime,\n        xhrbin: support_xhrbin,\n        xhrbytes: support_xhrprogress,\n        xdr: support_xdr,\n        formdata: !!G.FormData,\n        file: !!G.File,\n        blob: !!G.Blob\n    };\n\nG = XHR = null;","'use strict';\n\nimport {\n            string,\n            method,\n            createRegistry\n        } from \"libcore\";\n        \nimport { get as getModule } from \"./chain.js\";\n\n\nvar DRIVERS = createRegistry(),\n    DEFAULT = null,\n    exported = {\n        register: register,\n        exists: exists,\n        use: use,\n        get: get\n    };\n    \n/**\n * driver management\n */\nexport\n    function register(name, Class) {\n            \n        if (string(name) && method(Class)) {\n            DRIVERS.set(name, Class);\n            Class.prototype.type = name;\n            \n            if (!DEFAULT) {\n                DEFAULT = name;\n            }\n        }\n        \n        return getModule();\n    }\nexport\n    function exists(name) {\n        return DRIVERS.exists(name);\n    }\n\nexport\n    function use(name) {\n        if (arguments.length > 0 && exists(name)) {\n            DEFAULT = name;\n        }\n        return DEFAULT;\n    }\n\n/**\n * driver process\n */\nexport\n    function get(type) {\n        return DRIVERS.get(type);\n    }\n\nexport default exported;","'use strict';\n\n\nimport { string } from \"libcore\";\n        \nvar MIME_TYPE_RE =\n        /^([a-z0-9\\-\\_]+)\\/([a-z\\-\\_0-9]+)(([ \\s\\t]*\\;([^\\;]+))*)$/,\n    MIME_TYPE_PARAMS_RE =\n        /^[ \\t\\s]*([a-z0-9\\-\\_]+)\\=(\\\"([^\\\"]+)\\\"|[a-z0-9\\-\\_]+)[ \\t\\s]*$/,\n    QUOTED_RE = /^\\\"[^\\\"]+\\\"/,\n    exported = {\n        parse: parseType\n    };\n\n\n    function parseType(type) {\n        var mtypeRe = MIME_TYPE_RE,\n            paramRe = MIME_TYPE_PARAMS_RE,\n            quotedRe = QUOTED_RE,\n            paramGlue = \"; \",\n            parameterObject = null;\n            \n        var match, subtype, parameters, name, value, l, defaultType;\n        \n        if (string(type) && mtypeRe.test(type)) {\n            match = type.match(mtypeRe);\n            type = match[1].toLowerCase();\n            subtype = match[2].toLowerCase();\n            parameters = match[3] || '';\n            \n            if (parameters) {\n                parameterObject = {};\n                parameters = parameters.split(';');\n                l = parameters.length;\n                \n                for (; l--;) {\n                    match = parameters[l].match(paramRe);\n                    if (match) {\n                        name = match[1].toLowerCase();\n                        value = match[2];\n                        \n                        // create parameters string\n                        parameters[l] = name + '=' + value;\n                        \n                        // register\n                        parameterObject[name] = quotedRe.test(value) ?\n                                                    value.substring(1,\n                                                                value.length -1) :\n                                                    value;\n                        \n                    }\n                }\n                parameters = parameters.join(paramGlue);\n            }\n            \n            defaultType = type + '/' + subtype;\n            \n            return {\n                string: defaultType +\n                        (parameters ?\n                            paramGlue + parameters : ''),\n                root: defaultType,\n                type: type,\n                subtype: subtype,\n                params: parameterObject\n            };\n        }\n        \n        return void(0);\n    }\n    \nexport { parseType as parse };\n\nexport default exported;\n","'use strict';\n\nimport {\n            string,\n            object,\n            array,\n            date,\n            contains,\n            each as eachProperty\n            \n        } from \"libcore\";\n\nimport {\n            is\n        } from \"libdom\";\n\nvar TYPE_OBJECT = 1,\n    TYPE_ARRAY = 2;\n\n\n\nfunction isForm(form) {\n    return is(form, 1) && form.tagName.toUpperCase() === 'FORM';\n}\n\nfunction isField(field) {\n    if (is(field, 1)) {\n        switch (field.tagName.toUpperCase()) {\n        case 'INPUT':\n        case 'TEXTAREA':\n        case 'BUTTON':\n        case 'SELECT':\n        case 'OUTPUT': return true;\n        }\n    }\n    return false;\n}\n\nfunction onEachObjectValueProperty(value, name) {\n    /* jshint validthis: true */\n    var context = this;\n    \n    eachField(value,\n              name,\n              context[1],\n              context[0]);\n}\n\nfunction eachValues(values, callback, operation) {\n    var typeObject = TYPE_OBJECT,\n        typeArray = TYPE_ARRAY,\n        type = null,\n        each = eachField,\n        isObject = object,\n        isObjectValue = isObject(values);\n        \n    var c, l;\n    \n    if (isForm(values)) {\n        values = values.elements;\n        type = typeArray;\n        isObjectValue = false;\n    }\n    else if (isField(values)) {\n        type = typeArray;\n        values = [values];\n    }\n    else if (isObjectValue) {\n        type = typeObject;\n    }\n    else if (array(values)) {\n        type = typeArray;\n        isObjectValue = false;\n    }\n    \n    if (!isObject(operation)) {\n        operation = {};\n    }\n    \n    if (!contains(operation, 'returnValue')) {\n        operation.returnValue = null;\n    }\n    \n    if (isObjectValue || type === typeArray) {\n        if (isObjectValue) {\n            eachProperty(values,\n                         onEachObjectValueProperty,\n                         [operation, callback],\n                         true);\n        }\n        else {\n            for (c = -1, l = values.length; l--;) {\n                each(values[++c], null, callback, operation);\n            }\n        }\n    }\n    \n    return operation.returnValue;\n}\n\nfunction eachField(field, name, callback, operation) {\n    var isString = string,\n        hasName = isString(name),\n        fieldType = 'variant';\n    var type, c, l, list, option;\n    \n    if (isField(field)) {\n        if (!hasName && !isString(name = field.name)) {\n            return;\n        }\n        type = 'field';\n        hasName = true;\n        fieldType = field.type;\n        \n        // field exception by tagname\n        switch (field.tagName.toUpperCase()) {\n        case \"BUTTON\":\n            if (!isString(fieldType)) {\n                fieldType = \"button\";\n            }\n            break;\n\n        case \"SELECT\":\n            type = 'field-options';\n            fieldType = 'select';\n            list = field.options;\n            for (c = -1, l = list.length; l--;) {\n                option = list[++c];\n                // run callback\n                if (option.selected) {\n                    callback(operation,\n                            name,\n                            option.value,\n                            type,\n                            fieldType);\n                }\n            }\n            list = option = null;\n            return;\n        \n        case \"TEXTAREA\":\n            fieldType = \"text\";\n            break;\n        }\n        \n        // field exception by type\n        switch (fieldType) {\n        case \"checkbox\":\n        case \"radio\":\n            if (!field.checked) {\n                return;\n            }\n        }\n        \n    }\n    else {\n        switch (true) {\n        case array(field):\n            type = 'array';\n            break;\n        case date(field):\n            type = 'date';\n            break;\n        default:\n            type = typeof field;\n        }\n    }\n    \n    if (hasName) {\n        callback(operation, name, field, type, fieldType);\n    }\n}\n\nexport\n    function jsonify(raw) {\n        var json = global.JSON,\n            data = null;\n            \n        if (!json) {\n            throw new Error(\"JSON is not supported in this platform\");\n        }\n        try {\n            data = json.stringify(raw);\n        }\n        catch (e) {}\n        return data === 'null' || data === null ? '' : data;\n    }\n\nexport {\n            eachValues as each,\n            isForm as form,\n            isField as field\n        };\n\nexport default {\n                each: eachValues,\n                form: isForm,\n                field: isField,\n                jsonify: jsonify\n            };\n","'use strict';\n\nimport {\n            string,\n            jsonFill\n        } from \"libcore\";\n        \nimport {\n            jsonify,\n            each\n        } from \"./helper.js\";\n\n\nfunction createValue(operation, name, value, type, fieldType) {\n    var items = operation.returnValue,\n        isField = type === \"field\";\n    \n    if (isField) {\n        // i can't support file upload\n        if (fieldType === \"file\") {\n            return;\n        }\n        value = value.value;\n    }\n    \n    if (value === 'number') {\n        value = isFinite(value) ? value.toString(10) : '';\n    }\n    else if (!string(value)) {\n        value = jsonify(value);\n    }\n    \n    // this type of encoding is only available in form fields\n    if ((isField || type === 'field-options')) {\n        \n        // use libcore to fill-in json\n        jsonFill(items, name, value);\n        \n    }\n    else {\n        \n        items[name] = value;\n        \n    }\n    items = value = null;\n\n}\n\nfunction convert(data) {\n    var operation = {\n            index: {},\n            returnValue: {}\n        },\n        body = each(data, createValue, operation);\n    \n    return [null, jsonify(body)];\n}\n\nexport default convert;\n","'use strict';\n\nimport { string } from \"libcore\";\n\nvar json = global.JSON;\n\nif (!json) {\n    json = false;\n}\n\n\nfunction convert(data) {\n    \n    if (!json) {\n        throw new Error(\"JSON is not supported in this platform\");\n    }\n    else if (!string(data)) {\n        return null;\n    }\n    \n    try {\n        data = json.parse(data);\n    }\n    catch (e) {\n        return null;\n    }\n    \n    return [null, data];\n}\n\nexport default convert;","'use strict';\n\nimport {\n            each,\n            jsonify\n        } from \"./helper.js\";\n\nfunction createValue(operation, name, value, type, fieldType) {\n    var items = operation.returnValue;\n    \n    if (type === 'field') {\n        // i can't support file upload\n        if (fieldType === \"file\") {\n            return;\n        }\n        value = value.value;\n    }\n    \n    if (typeof value === 'number') {\n        value = isFinite(value) ? value.toString(10) : '';\n    }\n    else if (typeof value !== 'string') {\n        value = jsonify(value);\n    }\n    \n    // encode\n    items[items.length] = name + '=' + encodeURIComponent(value);\n}\n\n\nfunction convert(data) {\n    var body = each(data, createValue, {\n                    returnValue: []\n                });\n    \n    return [null, body.join('&')];\n}\n\nexport default convert;\n","'use strict';\n\nimport {\n            each,\n            jsonify\n        } from \"./helper.js\";\n\nvar EOL = \"\\r\\n\",\n    BOUNDARY_LENGTH = 48;\n\nfunction createBoundary() {\n    var ender = Math.random().toString().substr(2),\n        output = [],\n        len = 0,\n        total = BOUNDARY_LENGTH - ender.length;\n    \n    for (; total--;) {\n        output[len++] = '-';\n    }\n    output[len++] = ender;\n    return output.join('');\n}\n\nfunction createValue(operation, name, value, type, fieldType) {\n    var eol = EOL,\n        items = operation.returnValue;\n    \n    if (type === 'field') {\n        // i can't support file upload\n        if (fieldType === \"file\") {\n            return;\n        }\n        value = value.value;\n    }\n    \n    if (typeof value === 'number') {\n        value = isFinite(value) ? value.toString(10) : '';\n    }\n    else if (typeof value !== 'string') {\n        value = jsonify(value);\n    }\n    \n    // encode\n    items[items.length] = ([\n                'Content-Disposition: form-data; name=\"' + name + '\"',\n                'Content-type: application/octet-stream',\n                eol,\n                value\n            ]).join(eol);\n    \n}\n\nfunction convert(data) {\n    var eol = EOL,\n        boundary = createBoundary(),\n        body = each(data,\n                    createValue, {\n                        returnValue: []\n                    });\n    // start boundary\n    if (!body.length) {\n        body.splice(0, 0, boundary);\n    }\n    \n    \n    return [\n        // create header\n        ([\n            'Content-Type: multipart/form-data; charset=utf-8;',\n            '    boundary=' + boundary\n        ]).join(eol),\n        \n        // start boundary\n        boundary + eol +\n        \n        body.join(eol + boundary + eol) +\n        \n        // end boundary\n        boundary + '--' + eol\n    ];\n    \n}\n\n\nexport default convert;","'use strict';\n\nimport {\n            array,\n            method,\n            createRegistry\n        } from \"libcore\";\n        \nimport { get as getModule } from \"./chain.js\";\n\nimport { parse } from \"./type.js\";\n\nimport transformRequestJSON from \"./transform/request-json.js\";\n\nimport transformResponseJSON from \"./transform/response-json.js\";\n\nimport transformRequestURLEncode\n            from \"./transform/request-form-urlencoded.js\";\n            \nimport transformRequestFormMultipart\n            from \"./transform/request-form-multipart.js\";\n\nvar TRANSFORMERS = createRegistry(),\n    REQUEST_PREFIX = 'request-',\n    RESPONSE_PREFIX = 'response-',\n    exported = {\n        register: register,\n        transform: transform\n    };\n\nexport\n    function register(type, response, handler) {\n        var transformers = TRANSFORMERS,\n            responsePrefix = RESPONSE_PREFIX;\n        var finalType, current, all;\n        \n        if (method(handler)) {\n            type = parse(type);\n            if (type) {\n                all = response === 'all';\n                response = response === true ? REQUEST_PREFIX : responsePrefix;\n                \n                finalType = response + type.root;\n                current = response + type.string;\n                \n                // register root\n                if (current !== finalType && !transformers.exists(finalType)) {\n                    transformers.set(finalType, handler);\n                }\n                \n                transformers.set(current, handler);\n                \n                // include response\n                if (all) {\n                    transformers.set(responsePrefix + type.string, handler);\n                }\n                \n            }\n        }\n        return getModule();\n    }\n\nexport\n    function transform(type, response, data) {\n        var transformers = TRANSFORMERS;\n        var finalType;\n        \n        type = parse(type);\n        \n        if (type) {\n            response = response === true ? REQUEST_PREFIX : RESPONSE_PREFIX;\n            \n            \n            finalType = response + type.string;\n            if (transformers.exists(finalType)) {\n                return transformers.get(finalType)(data);\n            }\n            \n            // try root\n            finalType = response + type.root;\n            if (transformers.exists(finalType)) {\n                data = transformers.get(finalType)(data);\n                return array(data) ? data : [null, null];\n            }\n            \n        }\n        \n        return [null, data];\n    }\n\nexport default exported;\n\n\n/**\n * add default transformers\n */\n\nregister('application/json', false, transformRequestJSON);\n    register('text/x-json', false, transformRequestJSON);\n    \n// response json\nregister('application/json', true, transformResponseJSON);\nregister('text/x-json', true, transformResponseJSON);\n\n\n// old school requests\nregister('application/x-www-form-urlencoded',\n        false,\n        transformRequestURLEncode);\n\nregister('multipart/form-data',\n    false,\n    transformRequestFormMultipart);\n    \n\n    \n","'use strict';\n\nimport {\n            method as isFunction\n        } from \"libcore\";\n        \n\n\nfunction bind(instance, method) {\n    function bound() {\n        return method.apply(instance, arguments);\n    }\n    return bound;\n}\n\nfunction Driver() {\n    var me = this,\n        list = this.bindMethods,\n        len = list.length,\n        bindMethod = bind;\n    var name;\n    for (; len--;) {\n        name = list[len];\n        me[name] = bindMethod(me, me[name]);\n    }\n}\n\nDriver.prototype = {\n    bindMethods: [\n        'setup',\n        'transport',\n        'process',\n        'success',\n        'error'\n    ],\n    aborted: false,\n    request: null,\n    response: null,\n    \n    constructor: Driver,\n    \n    /* jshint unused:false */\n    onSetup: function (request) {\n        \n    },\n    \n    /* jshint unused:false */\n    onTransport: function (request) {\n        \n    },\n    \n    onCleanup: function (request) {\n        \n    },\n    \n    onSuccess: function (request, status) {\n        \n    },\n    \n    onError: function (status) {\n        \n        \n    },\n    \n    setup: function (request) {\n        var me = this;\n        me.request = request;\n        me.onSetup(request);\n        request.process();\n        me.response = request.response;\n        return request;\n    },\n    \n    /* jshint unused:false */\n    transport: function (request) {\n        var transportPromise;\n        \n        this.onTransport(request);\n        \n        // it's a promise! :-)\n        transportPromise = request.transportPromise;\n        if (transportPromise &&\n            isFunction(transportPromise.then)) {\n            \n            request.begin();\n            \n            return transportPromise;\n        }\n        \n        return Promise.reject(610);\n    },\n    \n    /* jshint unused:false */\n    success: function (status) {\n        var me = this,\n            request = me.request,\n            response = request && request.response;\n        \n        // aborted request or errors\n        if (status === 0 ||\n            (status < 200 && status > 299) ||\n            !request || !response) {\n            \n            return me.error(status);\n        }\n        \n        // process response\n        me.onSuccess(request, status);\n        response.process();\n        \n        // end request and response\n        request.end();\n        response.end();\n        \n        request.transportPromise = null;\n        me.onCleanup(request, response);\n        \n        delete me.request;\n        \n        return response;\n        \n    },\n    \n    error: function (status) {\n        var me = this,\n            request = me.request,\n            response = request && request.response;\n        \n        me.onError(status);\n        \n        // process response\n        if (request) {\n            request.transportPromise = null;\n            \n            me.onCleanup(request);\n            request.end();\n        }\n        \n        // end response\n        if (response) {\n            response.end();\n        }\n        \n        delete me.request;\n        return Promise.reject(status);\n    },\n    \n    abort: function () {\n        //var me = this,\n        //    request = me.request;\n        //\n        //if (!me.aborted) {   \n        //    me.aborted = true;\n        //    \n        //    if (request && LIBCORE.method(request.resolve)) {\n        //        request.resolve(0);\n        //    }\n        //}\n    }\n};\n\nexport default Driver;\n","'use strict';\n\nimport {\n            object,\n            array,\n            each,\n            instantiate,\n            middleware\n        } from \"libcore\";\n\nimport BASE from \"./base.js\";\n\nvar MIDDLEWARE = middleware(\"libdom-http.driver.xhr\"),\n    STATE_UNSENT = 0,\n    STATE_OPENED = 1,\n    STATE_HEADERS_RECEIVED = 2,\n    STATE_LOADING = 3,\n    STATE_DONE = 4,\n    BASE_PROTOTYPE = BASE.prototype;\n\n\nfunction applyHeader(value, name) {\n    /* jshint validthis:true */\n    var me = this;\n    var c, l;\n    if (!array(value)) {\n        value = [value];\n    }\n    for (c = -1, l = value.length; l--;) {\n        me.setRequestHeader(name, value[++c]);\n    }\n}\n\n\nfunction Xhr() {\n    var me = this,\n        args = [me];\n    BASE.apply(me, arguments);\n    \n    MIDDLEWARE.run(\"after:instantiated\", args);\n    \n    args = args[0] = null;\n}\n\n\nXhr.prototype = instantiate(BASE, {\n    level: 1,\n    bindMethods: BASE_PROTOTYPE.bindMethods.concat([\n                    'onReadyStateChange'\n                ]),\n    \n    constructor: Xhr,\n    \n    onReadyStateChange: function () {\n        var me = this,\n            request = me.request,\n            xhr = request.xhrTransport,\n            run = MIDDLEWARE.run,\n            args = [me, request],\n            resolve = request.resolve,\n            reject = request.reject;\n        var status;\n        \n        if (!request.aborted && resolve && reject) {\n            \n            run(\"before:readystatechange\", args);\n            \n            switch (xhr.readyState) {\n            case STATE_UNSENT:\n            case STATE_OPENED:\n            case STATE_HEADERS_RECEIVED: \n            case STATE_LOADING: break;\n            case STATE_DONE:\n                status = xhr.status;\n                if (status < 200 || status > 299) {\n                    reject(status);\n                }\n                else {\n                    resolve(status);\n                }\n            }\n            run(\"after:statechange\", args);\n        }\n        me = xhr = request = args = args[0] = args[1] = null;\n    },\n    \n    createTransportPromise: function(request) {\n        function bind(resolve, reject) {\n            var local = request;\n            local.resolve = resolve;\n            local.reject = reject;\n            local = null;\n        }\n        return new Promise(bind);\n    },\n    \n    onSetup: function (request) {\n        var me = this,\n            args = [me, request],\n            run = MIDDLEWARE.run,\n            xhr = new (global.XMLHttpRequest)();\n            \n        \n        request.xhrTransport = xhr;\n        \n        run(\"before:setup\", args);\n        \n        xhr.onreadystatechange = me.onReadyStateChange;\n        xhr.open(request.method.toUpperCase(), request.getUrl(), true);\n        \n        \n        run(\"after:setup\", args);\n        \n        xhr = args = args[0] = args[1] = null;\n        \n    },\n    \n    onTransport: function (request) {\n        var me = this,\n            xhr = request.xhrTransport,\n            headers = request.headers,\n            args = [me, request];\n       \n        MIDDLEWARE.run(\"before:request\", args);\n       \n        request.transportPromise = me.createTransportPromise(request);\n        \n        \n        \n        // apply headers\n        headers = request.headers;\n        if (object(headers)) {\n            each(headers, applyHeader, xhr);\n        }\n        \n        xhr.send(request.body);\n        \n        MIDDLEWARE.run(\"after:request\", args);\n        \n        \n        xhr = args = args[0] = args[1] = null;\n        \n        \n    },\n    \n    // process success\n    onSuccess: function (request) {\n        var me = this,\n            xhr = request.xhrTransport,\n            response = request.response,\n            args = [me, request],\n            run = MIDDLEWARE.run;\n        \n        response.status = xhr.status;\n        response.statusText = xhr.statusText;\n        response.addHeaders(xhr.getAllResponseHeaders());\n        response.body = xhr.responseText;\n        \n        run(\"after:response\", args);\n        \n        xhr = args = args[0] = args[1] = null;\n        \n    },\n    \n    onCleanup: function (request) {\n        var me = this,\n            xhr = request.xhrTransport;\n        var args;\n        \n        if (xhr) {\n            args = [me, request];\n            MIDDLEWARE.run(\"after:cleanup\", args);\n            args = args[0] = args[1] = \n                    xhr = xhr.onreadystatechange = null;\n        }\n        \n        request.transportPromise = \n            request.resolve =\n            request.reject = \n            request.xhrTransport = xhr = null;\n    }\n\n});\n\n\n\nexport default Xhr;","'use strict';\n\nimport {\n            number,\n            middleware\n        } from \"libcore\";\n        \nimport {\n            on,\n            un\n        } from \"libdom\";\n\nimport DETECT from \"../detect.js\";\n\nimport XHR from \"./xhr.js\";\n\nvar MIDDLEWARE = middleware(\"libdom-http.driver.xhr\"),\n    register = MIDDLEWARE.register,\n    BEFORE_REQUEST = \"before:request\",\n    PROTOTYPE = XHR.prototype,\n    BINDS = PROTOTYPE.bindMethods,\n    BIND_LENGTH = BINDS.length,\n    PROGRESS = DETECT.xhrbytes,\n    features = 0;\n\n// timeout\nfunction addTimeout(instance, request) {\n    var timeout = request.settings('timeout');\n    \n    if (number(timeout) && timeout > 10) {\n        request.xhrTransport.timeout = timeout;\n    }\n}\n\n// withCredentials\nfunction addWithCredentials(instance, request) {\n\n    if (request.settings('withCredentials') === true) {\n        request.xhrTransport.withCredentials = true;\n    }\n}\n\n// Progress\nfunction onProgress(event) {\n    /* jshint validthis: true */\n    var instance = this,\n        request = instance.request,\n        api = request.api;\n    var loaded;\n    \n    if (request && event.lengthComputable) {\n        loaded = event.loaded / event.total;\n        \n        request.percentLoaded = loaded;\n        if (api) {\n            api.percentLoaded = loaded;\n        }\n    }\n\n}\n\nfunction addProgressEvent(instance, request) {\n    var api = request.api;\n    \n    api.percentLoaded = 0;\n    \n    if (request) {\n        request.percentLoaded = 0;\n    }\n    \n    on(request.xhrTransport, 'progress', instance.onProgress);\n}\n\n// cleanup\nfunction cleanup(instance, request) {\n    if (PROGRESS) {\n        un(request.xhrTransport, 'progress', instance.onProgress);\n    }\n}\n\n\nfunction processFormData(instance, request) {\n\n    // remove content type and use FormData defaults\n    if (request.body instanceof global.FormData) {\n        delete request.headers['Content-type'];\n    }\n\n}\n\n\n\n// apply middlewares according to capability of the platform\nif (DETECT.xhrx) {\n    features++;\n    register(BEFORE_REQUEST, addWithCredentials);\n}\n\n// form data fixes\nif (DETECT.formdata) {\n    features++;\n    register(BEFORE_REQUEST, processFormData);\n}\n\n// progress\nif (PROGRESS) {\n    features++;\n    BINDS[BIND_LENGTH++] = 'onProgress';\n    PROTOTYPE.onProgress = onProgress;\n    register(BEFORE_REQUEST, addProgressEvent);\n}\n\n// timeout\nif (DETECT.xhrtime) {\n    register(BEFORE_REQUEST, addTimeout);\n}\n\n\n\n// cleanup\nif (features) {\n    if (features > 2) {\n        PROTOTYPE.level = 2;\n    }\n    register(\"cleanup\", cleanup);\n}\n\n\nexport default XHR;","\"use strict\";\n\nimport {\n            string,\n            array,\n            clear,\n            instantiate\n        } from \"libcore\";\n        \nimport {\n            on,\n            un,\n            dispatch,\n            replace,\n            remove\n        } from \"libdom\";\n\n\nimport {\n            jsonify,\n            each\n        } from \"../transform/helper.js\";\n\nimport BASE from \"./base.js\";\n\nvar BASE_PROTOTYPE = BASE.prototype,\n    RESPONSE_TRIM = /(^<pre>|<\\/pre>$)/ig,\n    FILE_UPLOAD_GEN = 0;\n\nfunction createForm(method, url, contentType, blankDocument) {\n    var doc = global.document,\n        id = 'libdom-http-oldschool-form' + (++FILE_UPLOAD_GEN),\n        div = doc.createElement('div');\n    var iframe;\n        \n    div.style.cssText = ([\n            \"visibility: hidden\",\n            \"position: fixed\",\n            \"top: -10px\",\n            \"left: -10px\",\n            \"overflow: hidden\",\n            \"height: 1px\",\n            \"width: 1px\"\n        ]).join(\";\");\n    \n    div.innerHTML = ([\n            '<form id=\"', id ,'\"',\n                ' method=\"', method.toUpperCase(),'\"',\n                ' action=\"', encodeURI(url),'\"',\n                ' target=\"', id,'-result\"',\n                ' enctype=\"', contentType, '\"',\n                ' encoding=\"', contentType,'\"',\n                ' data-readystate=\"uninitialized\">',\n                '<iframe name=\"', id,'-result\"',\n                    ' id=\"', id, '-result\">',\n                    ' src=\"' + blankDocument + '\">',\n                '</iframe>',\n            '</form>'\n        ]).join(\"\");\n    \n    iframe = div.firstChild.firstChild;\n    \n    on(iframe, 'load', frameFirstOnloadEvent);\n    \n    doc.body.appendChild(div);\n    \n    doc = div = iframe = null;\n    return id;\n}\n\nfunction frameFirstOnloadEvent(event) {\n    var target = event.target,\n        form = target.parentNode;\n        \n    un(target, 'load', frameFirstOnloadEvent);\n    \n    form.setAttribute('data-readystate', 'ready');\n    \n    dispatch(form, 'libdom-http-ready', {});\n    \n    target = form = null;\n}\n\nfunction getForm(id) {\n    return global.document.getElementById(id);\n}\n\nfunction createField(operation, name, value, type, fieldType) {\n    var impostors = operation.impostors,\n        fragment = operation.fragment,\n        isField = type === \"field\",\n        isFile = isField && fieldType === \"file\",\n        input = null;\n    var parent;\n    \n    // include only if it has value\n    if (isFile && value.value) {\n        \n        parent = value.parentNode;\n        if (parent) {\n            input = value.cloneNode();\n            input.disabled = true;\n            input.readOnly = true;\n            impostors[impostors.length] = [value, input];\n            replace(value, input);\n        }\n        input = value;\n        operation.files = true;\n        \n    }\n    else if (!isFile) {\n        \n        if (isField) {\n            value = value.value;\n        }\n        \n        if (value === 'number') {\n            value = isFinite(value) ? value.toString(10) : '';\n        }\n        else if (!string(value)) {\n            value = jsonify(value);\n        }\n        \n        input = fragment.ownerDocument.createElement('input');\n        input.type = \"hidden\";\n        input.name = name;\n        input.value = value;\n        \n    }\n    \n    if (input) {\n        fragment.appendChild(input);\n    }\n    \n    fragment = parent = input = null;\n    \n}\n\nfunction revertImpostors(impostors) {\n    var l, pair, original, impostor, parent;\n    \n    for (l = impostors.length; l--;) {\n        pair = impostors[l];\n        original = pair[0];\n        impostor = pair[1];\n        parent = impostor.parentNode;\n        if (parent) {\n            parent.replaceChild(original, impostor);\n        }\n        parent = pair = pair[0] = pair[1] = original = impostor = null;\n    }\n\n}\n\n    \nfunction FormUpload() {\n    var me = this;\n        \n    BASE.apply(me, arguments);\n\n}\n\n\nFormUpload.prototype = instantiate(BASE, {\n    constructor: FormUpload,\n    \n    blankDocument: 'about:blank',\n    defaultType: 'application/json',\n    \n    bindMethods: BASE_PROTOTYPE.bindMethods.concat([\n                    'onFormReady',\n                    'onFormDeferredSubmit',\n                    'onRespond'\n                ]),\n    \n    createTransportPromise: function (request) {\n        function bind(resolve, reject) {\n            var local = request;\n            local.resolve = resolve;\n            local.reject = reject;\n        }\n        return new Promise(bind);\n    },\n    \n    onFormReady: function () {\n        var me = this,\n            request = me.request,\n            form = request.form;\n\n        // unset event if it was set\n        un(form, 'libdom-http-ready', me.onFormReady);\n        \n        form.enctype = form.encoding = request.contentType;\n        \n        request.deferredSubmit = global.setTimeout(me.onFormDeferredSubmit, 10);\n        \n        form = null;\n        \n        \n    },\n    \n    onFormDeferredSubmit: function () {\n        var me = this,\n            request = me.request,\n            form = request && request.form;\n        \n        if (form) {\n            on(request.iframe, 'load', me.onRespond);\n            form.submit();\n            \n        }\n        else if (request) {\n            request.reject(408);\n        }\n        \n        request = form = null;\n    },\n    \n    onRespond: function () {\n        var me = this,\n            request = me.request,\n            iframe = request.iframe,\n            success = false,\n            docBody = '';\n        \n        un(iframe, 'load', me.onRespond);\n        \n        try {\n            docBody = iframe.contentWindow.document.body.innerHTML;\n            success = true;\n        }\n        catch (e) {}\n\n        if (success) {\n            request.formResponse = docBody.replace(RESPONSE_TRIM, \"\");\n            request.resolve(200);\n        }\n        else {\n            request.reject(406);\n        }\n        \n        iframe = null;\n        \n    },\n    \n    onSetup: function (request) {\n        var me = this,\n            impostors = [],\n            id = createForm(request.method,\n                            request.getUrl(),\n                            request.contentType,\n                            me.blankDocument),\n            form = getForm(id),\n            operation = {\n                impostors: impostors,\n                fragment: global.document.createDocumentFragment(),\n                files: false,\n                driver: me,\n                request: request\n            },\n            currentResponseType = request.responseType;\n            \n        // recreate request\n        each(request.data, createField, operation);\n        \n        // add fields\n        form.appendChild(operation.fragment);\n        request.form = form;\n        request.iframe = form.firstChild;\n        request.impostors = operation.impostors;\n        request.fileUpload = operation.files;\n        \n        // use application.json as default response type\n        if (!string(currentResponseType)) {\n            request.responseType = me.defaultType;\n        }\n        \n        // cleanup operation\n        clear(operation);\n        \n        request.transportPromise = me.createTransportPromise(request);\n        \n        form = null;\n        \n    },\n    \n    onTransport: function (request) {\n        \n        var form = request.form,\n            contentType = 'application/x-www-form-urlencoded';\n        \n        // set proper content-type\n        if (request.fileUpload) {\n            contentType = 'multipart/form-data';\n        }\n        \n        request.addHeaders('Content-type: ' + contentType);\n        \n        if (form.getAttribute('data-readystate') === 'ready') {\n            this.onFormReady();\n        }\n        else {\n            on(form, 'libdom-http-ready', this.onFormReady);\n        }\n        \n    },\n    \n    onSuccess: function (request) {\n        var me = this,\n            response = me.response,\n            responseBody = request.formResponse;\n        \n        if (string(responseBody)) {\n            response.body = responseBody;\n        }\n    },\n    \n    onCleanup: function (request) {\n        var impostors = request.impostors,\n            form = request.form;\n        \n        // return impostors\n        if (array(impostors)) {\n            revertImpostors(impostors);\n        }\n        \n        if (form) {\n            remove(form.parentNode || form);\n        }\n        \n        request.transportPromise = \n            request.resolve =\n            request.reject = \n            request.form = form = null;\n    }\n\n    \n});\n\nexport default FormUpload;\n","'use strict';\n\nimport {\n            number,\n            string\n        } from \"libcore\";\n\nfunction convert(data) {\n    \n    if (number(data)) {\n        data = data.toString(10);\n    }\n    \n    return ['Content-type: text/plain',\n            string(data) ?\n                data : ''];\n}\n\n\nexport default convert;","'use strict';\n\nimport {\n            string\n        } from \"libcore\";\n        \nimport {\n            jsonify,\n            each\n        } from \"./helper.js\";\n\n\nfunction appendFormData(operation, name, value, type, fieldType) {\n    var formData = operation.returnValue,\n        isString = string;\n    var list, c, l, filename;\n    \n    // don't use parsed name for formData\n    if (type === 'field') {\n        \n        if (fieldType === \"file\") {\n            list = value.files;\n            for (c = -1, l = list.length; l--;) {\n                value = list[++c];\n                filename = value.name;\n\n                if (isString(filename)) {\n                    formData.append(name, value, filename);\n                }\n                else {\n                    formData.append(name, value);\n                }\n            }\n            formData = null;\n            return;\n        }\n        value = value.value;\n    }\n\n        \n    // natives\n    if (typeof value === 'number') {\n        value = isFinite(value) ? value.toString(10) : '';\n    }\n    else if (typeof value !== 'string') {\n        value = jsonify(value);\n    }\n    formData.append(name, value);\n    \n    formData = null;\n}\n\n\nfunction convert(data) {\n    return [null,\n            each(data,\n                appendFormData,\n                {\n                    returnValue: new (global.FormData)()\n                })];\n    \n}\n\n\nexport default convert;","'use strict';\n\nimport {\n            string,\n            number,\n            object,\n            array,\n            contains,\n            each as eachProperty\n        } from \"libcore\";\n        \nvar LINE_SPLIT_RE = /\\r\\n|\\r|\\n/,\n    LINE_PAIR_RE = /^([^ \\r\\n\\t\\s\\:]+)\\:(.+)$/,\n    LINE_EXTENSION_RE = /^([ \\r\\n\\t\\s]+.+|[^\\:]+)$/,\n    LINE_REQUEST_RE =\n        /^([a-z]+)[ \\t\\s]+(\\/[^\\:]+)[ \\t\\s]+(HTTP\\/[0-9]+\\.[0-9]+)$/i,\n    LINE_RESPONSE_RE =\n        /^(HTTP\\/[0-9]+.[0-9]+)[ \\t\\s]+([0-9]+)[ \\t\\s]+([a-z0-9\\-\\_]+)$/i,\n    LINE_TRIM = /^[ \\t\\s]*(.+)[ \\t\\s]*$/,\n    MULTI_VALUE_RE = /Set\\-cookie/i,\n    exported = {\n        each: each,\n        parse: parse,\n        headerName: headerName\n    };\n\n\n\nfunction parseHeaderString(str, callback, scope) {\n    var lines = str.split(LINE_SPLIT_RE),\n        pairRe = LINE_PAIR_RE,\n        extensionRe = LINE_EXTENSION_RE,\n        requestRe = LINE_REQUEST_RE,\n        responseRe = LINE_RESPONSE_RE,\n        trimRe = LINE_TRIM,\n        multivalueRe = MULTI_VALUE_RE,\n        separator = ':',\n        trimReplace = \"$1\",\n        normalize = headerName,\n        l = lines.length,\n        c = -1,\n        headers = {},\n        names = [],\n        nl = 0,\n        name = null;\n    var line, index, value, values, exist;\n    \n    if (typeof scope === 'undefined') {\n        scope = null;\n    }\n        \n    // parse\n    for (; l--;) {\n        line = lines[++c];\n        \n        // header request/response\n        if (!c &&\n            requestRe.test(line) || responseRe.test(line)) {\n            names[nl++] = \"\";\n            headers[\"\"] = line;\n            continue;\n            \n        }\n        \n        // pair\n        if (pairRe.test(line)) {\n            index = line.indexOf(separator);\n            name = line.substring(0, index);\n            value = line.\n                        substring(index + 1, line.length).\n                        replace(trimRe, trimReplace);\n            \n            if (!value) {\n                continue;\n            }\n            \n            // normalize\n            name = normalize(name);\n            \n            \n            exist = contains(headers, name);\n            if (!exist) {\n                names[nl++] = name;\n            }\n            \n            if (multivalueRe.test(name)) {\n                if (!exist) {\n                    headers[name] = [];\n                }\n                values = headers[name];\n                values[values.length] = value;\n            }\n            else {\n                headers[name] = value;\n            }\n            \n        }\n        // continuation\n        else if (name && extensionRe.test(line)) {\n            value = line.replace(trimRe, trimReplace);\n            \n            if (multivalueRe.test(name)) {\n                values = headers[name];\n                values[values.length - 1] += ' ' + value;\n            }\n            else {\n                headers[name] += ' ' + value;\n            }\n            \n        }\n    }\n    \n    // callback\n    for (c = -1, l = names.length; l--;) {\n        name = names[++c];\n        callback.call(scope, name, headers[name]);\n    }\n}\n\n\n\nfunction parseCallback(name, values) {\n    \n    /* jshint validthis:true */\n    this[name] = values;\n}\n\nfunction cleanArrayValues(array) {\n    var isString = string,\n        isNumber = number,\n        l = array.length;\n    var value;\n    \n    for (; l--;) {\n        value = array[l];\n        if (isNumber(value)) {\n            array[l] = value.toString(10);\n        }\n        else if (!isString(value)) {\n            array.splice(l, 1);\n        }\n    }\n    return array;\n}\n\nfunction onEachInput(value, name) {\n    var context = this,\n        callback = context[0],\n        scope = context[1],\n        multivalueRe = MULTI_VALUE_RE;\n    \n    var len;\n    \n    name = headerName(name);\n    \n    if (string(value) || number(value)) {\n        callback.call(scope, name,\n                                multivalueRe.test(name) ?\n                                    [value] : value);\n    }\n    else if (array(value)) {\n        \n        value = cleanArrayValues(value.slice(0));\n        \n        if (!multivalueRe.test(name)) {\n            len = value.length;\n            value = len ? value[len - 1] : '';\n        }\n        \n        if (value.length) {\n            callback.call(scope, name, value);\n        }\n    }\n}\n\nexport \n    function headerName(name) {\n        if (!name) {\n            return '';\n        }\n        \n        return name.charAt(0).toUpperCase() +\n                    name.\n                        substring(1, name.length).\n                        toLowerCase();\n        \n    }\n    \nexport\n    function each(input, callback, scope, current) {\n        \n        // join as string\n        if (array(input)) {\n            input = cleanArrayValues(input.slice(0)).join(\"\\r\\n\");\n        }\n        \n        if (string(input)) {\n            parseHeaderString(input, callback, scope, current);\n            \n        }\n        else if (object(input)) {\n            \n            if (typeof scope === 'undefined') {\n                scope = null;\n            }\n            \n            eachProperty(input,\n                         onEachInput,\n                         [callback,\n                          scope\n                            \n                         ],\n                         true);\n            \n        }\n        else {\n            \n            return false;\n        }\n        \n        return true;\n        \n    }\n    \nexport\n    function parse(headers) {\n        var values = {};\n        return each(headers, parseCallback, values) && values;\n    }\n    \nexport default exported;\n","'use strict';\n\nimport {\n            string,\n            object,\n            assign,\n            contains,\n            clear,\n            instantiate\n        } from \"libcore\";\n        \nimport { destructor as domDestructor } from \"libdom\";\n        \nimport {\n            parse,\n            headerName\n        } from \"./header.js\";\n\nimport {\n            transform\n        } from \"./transform.js\";\n\nvar CLEANING = false,\n    CLEAN_INTERVAL = 1000,\n    TTL = 10000,\n    RUNNING = false,\n    OPERATIONS = [],\n    URL_QUERY_STRING_RE = /^([^\\?\\#]+)(\\?[^\\?\\#]*)?(\\#.*)?$/;\n    \nfunction applyQueryString(url, queryString) {\n    var match = url.match(URL_QUERY_STRING_RE);\n    var query;\n    \n    if (match && string(queryString)) {\n        query = match[2];\n        match[2] = (query ? query + '&' : '?') + queryString;\n        match[3] = match[3] || '';\n        return match.slice(1).join('');\n    }\n    \n    return url;\n}\n\n\n\nfunction onCleanup(force) {\n    var list = OPERATIONS,\n        id = RUNNING;\n    var len, operation, now, ttl, created;\n\n    if (!CLEANING) {\n        CLEANING = true;\n        now = (new Date()).getTime();\n        ttl = TTL;\n        force = force === true;\n        \n        for (len = list.length; len--;) {\n            operation = list[len];\n\n            if (force) {\n                operation.destroy();\n                \n            }\n            else if (!operation.destroyed) {\n                created = operation.createdAt;\n                \n                if (!created || operation.processing) {\n                    operation.createdAt = now;\n                }\n                else if (created + ttl < now) {\n                    operation.destroy();\n                }\n            }\n            \n            if (operation.destroyed) {\n                list.splice(len, 1);\n            }\n        }\n        \n        // unset running interval if no operations left\n        if (!list.length && id) {\n            clearInterval(id);\n            RUNNING = false;\n        }\n        CLEANING = false;\n    }\n}\n\nfunction runCleaner(force) {\n    var id = RUNNING;\n    \n    if (force === true) {\n        if (id) {\n            clearInterval(id);\n            RUNNING = false;\n        }\n        onCleanup(force);\n    }\n    else if (!id) {\n        RUNNING = setInterval(onCleanup, CLEAN_INTERVAL);\n    }\n}\n\nfunction destructor() {\n    runCleaner(true);\n}\n\nfunction Request() {\n    Operation.apply(this, arguments);\n}\n\nfunction Response() {\n    Operation.apply(this, arguments);\n}\n\n\nfunction Operation() {\n    var list = OPERATIONS,\n        me = this;\n    me.destroyed = false;\n    list[list.length] = me;\n    runCleaner();\n}\n\nOperation.prototype = {\n    \n    createdAt: void(0),\n    contentType: 'application/octet-stream',\n    headers: null,\n    body: null,\n    data: null,\n    destroyed: true,\n    processing: false,\n    constructor: Operation,\n    \n    begin: function () {\n        var me = this;\n        if (!me.destroyed && !me.processing) {\n            me.processing = true;\n            delete me.createdAt;\n            runCleaner();\n        }\n        return me;\n    },\n    \n    end: function () {\n        var me = this;\n        if (!me.destroyed && me.processing) {\n            delete me.processing;\n            delete me.createdAt;\n            runCleaner();\n        }\n        return me;\n    },\n    \n    addHeaders: function (headers) {\n        var me = this;\n        var current, contentType;\n            \n        headers = parse(headers);\n        \n        if (headers) {\n            current = me.headers;\n            if (object(current)) {\n                assign(current, headers);\n            }\n            else {\n                me.headers = headers;\n            }\n            \n            // apply content type from headers\n            contentType = me.header('content-type');\n            if (contentType) {\n                me.contentType = contentType;\n            }\n            else {\n                delete me.contenType;\n            }\n            \n        }\n        \n        return this;\n    },\n    \n    header: function (name) {\n        var me = this,\n            current = me.headers;\n        \n        if (string(name) && object(current)) {\n            name = headerName(name);\n            \n            if (contains(current, name)) {\n                return current[name];\n            }\n            \n        }\n        \n        return null;\n    },\n    \n    destroy: function () {\n        var me = this;\n        if (!me.destroyed) {\n            me.destroyed = true;\n            clear(me);\n        }\n        return me;\n    }\n};\n\n\nRequest.prototype = instantiate(Operation, {\n    url: null,\n    method: 'get',\n    constructor: Request,\n    response: null,\n    aborted: false,\n    timeout: 0,\n    config: null,\n    queryTransformer: 'application/x-www-form-urlencoded',\n    queryAllowed: true,\n    allowedPayload: true,\n    \n    getUrl: function () {\n        var me = this,\n            isString = string,\n            url = me.url,\n            query = me.query,\n            data = me.data,\n            transformerType = me.queryTransformer,\n            apply = applyQueryString;\n            \n        \n        if (me.queryAllowed && isString(url) && isString(transformerType)) {\n            // transform url\n            query = transform(transformerType, false, query)[1];\n            if (isString(query)) {\n                url = apply(url, query);\n            }\n            \n            // should include body as query string\n            if (me.allowedPayload === false) {\n                data = transform(transformerType, false, data)[1];\n                \n                if (isString(data)) {\n                    url = apply(url, data);\n                }\n            }\n        }\n        return url;\n    },\n    \n    settings: function (name) {\n        var config = this.config;\n            \n        if (object(config) && contains(config, name)) {\n            return config[name];\n        }\n        return void(0);\n    },\n    \n    process: function () {\n        var me = this,\n            result = transform(me.header('content-type'),\n                               false,\n                               me.data),\n            headers = result[0],\n            responseType = me.responseType,\n            response = me.response;\n        \n        // data will be parsed to create body based on the content type\n        if (headers) {\n            me.addHeaders(headers);\n        }\n        \n        if (me.allowedPayload === false) {\n            delete me.body;\n        }\n        else {\n            me.body = result[1];\n        }\n        \n        // create response\n        if (response) {\n            response.destroy();\n        }\n        \n        me.response = response = new Response();\n        \n        // use response type as resonse contentType\n        if (string(responseType)) {\n            response.addHeaders('Content-type: ' + responseType);\n        }\n        response.request = me;\n        response.begin();\n        \n        result = null;\n    }\n});\n\nResponse.prototype = instantiate(Operation, {\n    constructor: Response,\n    status: 0,\n    statusText: 'Uninitialized',\n    process: function () {\n        var me = this,\n            result = transform(me.header('content-type'),\n                                        true,\n                                        me.body),\n            headers = result[0];\n        \n        // body will be parsed to create data based on the content type\n        if (headers) {\n            me.addHeaders(headers);\n        }\n\n        me.data = result[1];\n        \n    }\n});\n\n\ndomDestructor(destructor);\n\nexport default Request;","'use strict';\n\nimport {\n            string,\n            object,\n            run,\n            createRegistry\n        } from \"libcore\";\n        \nimport { get as getModule } from \"./chain.js\";\n\nimport {\n            exists,\n            use,\n            get\n        } from \"./driver.js\";\n        \nimport OPERATION from \"./operation.js\";\n\nimport {\n            form\n        } from \"./transform/helper.js\";\n\n\nvar DEFAULTS = createRegistry(),\n    METHODS = ['get','post','put','patch','delete','options'],\n    ALLOWED_PAYLOAD = ['post', 'put', 'patch'],\n    exported = {\n        request: request,\n        defaults: defaults\n    };\n    \n\n\nfunction normalizeMethod(method) {\n    if (string(method)) {\n        method = method.toLowerCase();\n        if (METHODS.indexOf(method) !== -1) {\n            return method;\n        }\n    }\n    \n    return DEFAULTS.get('method');\n}\n\nfunction sniffDriver(config) {\n    var driver = config.driver;\n    \n    // call middleware\n    run(\"libdom-http.driver.resolve\", [config, driver]);\n    driver = config.driver;\n    \n    if (string(driver) && exists(driver)) {\n        return driver;\n    }\n    \n    // use default\n    return use();\n    \n}\n\nfunction applyRequestForm(form, requestObject) {\n    var isString = string;\n    var item;\n    \n    // use this as request header only if not default\n    item = form.getAttribute('enctype') || form.getAttribute('encoding');\n    if (isString(item)) {\n        requestObject.addHeaders('Content-type: ' + item);\n    }\n    \n    item = form.action;\n    if (isString(item)) {\n        requestObject.url = item;\n    }\n    \n    item = form.method;\n    if (isString(item)) {\n        requestObject.method = normalizeMethod(item);\n    }\n    \n    item = form.getAttribute('data-driver');\n    if (isString(item)) {\n        requestObject.driver = item;\n    }\n    \n    \n    item = form.getAttribute('data-response-type');\n    if (isString(item)) {\n        requestObject.responseType = item;\n    }\n    \n    requestObject.data = form;\n}\n\nfunction applyRequestConfig(config, requestObject) {\n    var isString = string,\n        undef = void(0);\n    var item;\n    \n    // apply defaults\n    item = config.form || config.data || config.params || config.body;\n    if (form(item)) {\n        applyRequestForm(item, requestObject);\n    }\n    else if (item !== null || item !== undef) {\n        requestObject.data = item;\n    }\n    \n    item = config.query || config.urlData || config.urlParams;\n    if (form(item) || (item !== null && item !== undef)) {\n        requestObject.query = item;\n    }\n    \n    item = config.url;\n    if (isString(item)) {\n        requestObject.url = item;\n    }\n    \n    item = config.method;\n    if (isString(item)) {\n        requestObject.method = normalizeMethod(item);\n    }\n    \n    item = config.driver;\n    if (isString(item)) {\n        requestObject.driver = item;\n    }\n    \n    item = config.responseType;\n    if (isString(item)) {\n        requestObject.responseType = item;\n    }\n    \n    // add headers\n    requestObject.addHeaders('headers' in config && config.headers);\n    \n    requestObject.config = config;\n    \n    item = null;\n}\n\nexport\n    function request(url, config) {\n        var isString = string,\n            isObject = object,\n            isForm = form,\n            applyConfig = applyRequestConfig,\n            requestObject = new OPERATION(),\n            PROMISE = Promise;\n        var driver, promise;\n        \n        // apply defaults\n        applyConfig(DEFAULTS.clone(), requestObject);\n        \n        // process config\n        if (isString(url)) {\n            \n            if (isObject(config)) {\n                applyConfig(config, requestObject);\n            }\n            else if (isForm(config)) {\n                applyRequestForm(config, requestObject);\n            }\n            \n            requestObject.url = url;\n            \n        }\n        else if (isObject(url)) {\n            applyConfig(url, requestObject);\n        }\n        else if (isForm(url)) {\n            applyRequestForm(url, requestObject);\n        }\n        \n        // decide if body is allowed or not based from methods\n        if (ALLOWED_PAYLOAD.indexOf(requestObject.method) === -1) {\n            requestObject.allowedPayload = false;\n        }\n        \n        \n        // validate\n        if (isString(requestObject.url)) {\n            \n            driver = sniffDriver(requestObject);\n            if (driver) {\n                driver = new (get(driver))(requestObject);\n                requestObject.driver = driver;\n                promise =  PROMISE.resolve(requestObject).\n                                then(driver.setup).\n                                then(driver.transport).\n                                then(driver.success)\n                                [\"catch\"](driver.error);\n                \n                requestObject.api = promise;\n                requestObject = driver = null;\n                return promise;\n            }\n            \n        }\n        \n        return PROMISE.reject(\"Invalid HTTP request configuration.\");\n        \n    }\n\nexport\n    function defaults(name, value) {\n        var all = DEFAULTS;\n        if (arguments.length > 1) {\n            all.set(name, value);\n            return getModule();\n        }\n        \n        return all.get(name);\n        \n    }\n\n\nexport default exported;\n\n\n// set default driver\nuse('xhr');\n\n// set default method\nDEFAULTS.set('method', 'get');\n\n// add default header\nDEFAULTS.set('headers', {\n    'accept': 'application/json,text/x-json,text/plain,*/*;q=0.8',\n    'content-type': 'application/json'\n});\n\n\n\n","'use strict';\n\nimport { env } from \"libcore\";\n\nimport DETECT from \"./lib/detect.js\";\n\nimport DRIVER,\n        {\n            register as driverRegister,\n            use\n        } from \"./lib/driver.js\";\n\nimport TRANSFORMER,\n        {\n            register as transformRegister,\n            transform\n        } from \"./lib/transform.js\";\n\n\nimport xhrDriver from \"./lib/driver/xhr.js\";\nimport xhrDriver2 from \"./lib/driver/xhr2.js\";\n\nimport formUploadDriver from './lib/driver/form-upload.js';\n\nimport transformTextResponseDriver\n            from \"./lib/transform/response-text-plain.js\";\n            \nimport transformFormDataRequestDriver\n            from \"./lib/transform/request-html5-form-data.js\";\n\n\nif (!global.libdom) {\n    throw new Error(\"libdom package is not found! unable to load http module\");\n}\n\n\n\nif (DETECT.xhr) {\n    driverRegister('xhr', xhrDriver);\n    \n    driverRegister('xhr2', xhrDriver2);\n}\n\n// file upload drivers\nif (env && env.browser) {\n    driverRegister('form-upload',\n        DETECT.xhr && DETECT.file && DETECT.blob ?\n            // form data\n            xhrDriver2 :\n            \n            // old school iframe\n            formUploadDriver);\n}\n\n// Transform Drivers\ntransformRegister('text/plain',\n    true,\n    transformTextResponseDriver);\n\n\nif (DETECT.formdata) {\n    \n    // use html5 form data request\n    transformRegister('multipart/form-data',\n        false,\n        transformFormDataRequestDriver);\n}\n\n\n\n        \n        \nexport {\n            use,\n            driverRegister as driver,\n            \n            transform,\n            transformRegister as transformer\n        };\n        \nexport {\n            request,\n            defaults\n        } from \"./lib/request.js\";\n\n\nexport {\n            parse as parseHeader,\n            each as eachHeader\n        } from \"./lib/header.js\";\n","'use strict';\n\n\nimport { use } from \"./lib/chain.js\";\n\nimport * as moduleApi from \"./all.js\";\n\nuse(moduleApi);\n\nexport * from \"./all.js\";\n\nexport default moduleApi;\n"],"names":["DOM","global","createRegistry","use","get","string","method","getModule","is","each","object","array","contains","eachProperty","date","isField","jsonFill","convert","createValue","exported","register","parse","transformRequestJSON","transformResponseJSON","transformRequestURLEncode","transformRequestFormMultipart","isFunction","middleware","BASE","instantiate","run","MIDDLEWARE","XHR","number","on","un","BASE_PROTOTYPE","dispatch","replace","clear","remove","destructor","assign","domDestructor","form","isForm","OPERATION","driverRegister","xhrDriver","xhrDriver2","env","formUploadDriver","transformRegister","transformTextResponseDriver","transformFormDataRequestDriver","moduleApi"],"mappings":"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"}